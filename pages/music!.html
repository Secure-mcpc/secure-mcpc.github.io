<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>极简音乐播放器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 300px;
            margin: 20px auto;
            padding: 10px;
            text-align: center;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            padding: 8px 15px;
            font-size: 16px;
            cursor: pointer;
        }
        #trackInfo {
            margin: 15px 0;
            min-height: 40px;
        }
    </style>
</head>
<body>
    <div id="trackInfo">点击播放开始</div>
    
    <div class="controls">
        <button id="prevBtn">上</button>
        <button id="playBtn">播放</button>
        <button id="nextBtn">下</button>
    </div>

    <script>
        // 固定音乐列表
        const musicList = [
            { title: "Dark Sanctuary", url: "https://secure-mcpc.github.io/music/Dark Sanctuary.mp3" },
            { title: "The Second Sanctuary", url: "https://secure-mcpc.github.io/music/The Second Sanctuary.mp3" },
            { title: "The Third Sanctuary", url: "https://secure-mcpc.github.io/music/The Third Sanctuary.mp3" },
            { title: "Rude Ruster", url: "https://secure-mcpc.github.io/music/Rude Ruster.mp3" }
        ];

        // 播放器状态
        let currentTrackIndex = 0;
        let isPlaying = false;
        let currentAudio = new Audio();
        let nextAudio = new Audio(); // 用于预加载

        // DOM元素
        const trackInfo = document.getElementById('trackInfo');
        const playBtn = document.getElementById('playBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // 初始化播放器
        function initPlayer() {
            loadTrack(currentTrackIndex);
            setupEventListeners();
        }

        // 加载指定曲目
        function loadTrack(index) {
            if (index < 0 || index >= musicList.length) return;
            
            currentTrackIndex = index;
            const track = musicList[currentTrackIndex];
            
            // 更新UI
            trackInfo.textContent = track.title;
            
            // 创建新的Audio对象
            const newAudio = new Audio(track.url);
            newAudio.loop = true; // 单曲循环
            
            // 切换音频源
            currentAudio.pause();
            currentAudio = newAudio;
            
            // 预加载下一首
            preloadNextTrack();
            
            // 自动播放如果之前是播放状态
            if (isPlaying) {
                currentAudio.play().catch(e => console.log('自动播放失败:', e));
            }
        }

        // 预加载下一首
        function preloadNextTrack() {
            const nextIndex = (currentTrackIndex + 1) % musicList.length;
            const nextTrack = musicList[nextIndex];
            
            nextAudio.src = nextTrack.url;
            nextAudio.load();
            nextAudio.volume = 0; // 静音预加载
        }

        // 播放/暂停切换
        function togglePlay() {
            if (currentAudio.paused) {
                currentAudio.play().then(() => {
                    isPlaying = true;
                    playBtn.textContent = '暂停';
                }).catch(e => {
                    console.log('播放失败:', e);
                    trackInfo.textContent = '点击播放按钮开始播放';
                });
            } else {
                currentAudio.pause();
                isPlaying = false;
                playBtn.textContent = '播放';
            }
        }

        // 上一曲
        function prevTrack() {
            const prevIndex = (currentTrackIndex - 1 + musicList.length) % musicList.length;
            loadTrack(prevIndex);
            if (isPlaying) {
                currentAudio.play().catch(e => console.log('播放失败:', e));
            }
        }

        // 下一曲
        function nextTrack() {
            const nextIndex = (currentTrackIndex + 1) % musicList.length;
            loadTrack(nextIndex);
            if (isPlaying) {
                currentAudio.play().catch(e => console.log('播放失败:', e));
            }
        }

        // 设置事件监听器
        function setupEventListeners() {
            playBtn.addEventListener('click', togglePlay);
            prevBtn.addEventListener('click', prevTrack);
            nextBtn.addEventListener('click', nextTrack);
        }

        // 初始化播放器
        initPlayer();
    </script>
</body>
</html>
